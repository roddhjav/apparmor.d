# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2021-2025 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only

# The user directories defined below mirror the directories defined in the user-read-strict and user-write-strict abstractions. In combination with, e.g.,
# the variables defined in .../tunables/multiarch.d/extensions they allow for rules like:
#    owner @{user_dirs_strict}/**.@{image_ext} rwkl,

@{user_dirs_strict} =  @{HOME} @{HOME}/[^.]* @{MOUNTS}
@{user_dirs_strict} += @{HOME}/@{XDG_DESKTOP_DIR} @{HOME}/@{XDG_SCREENSHOTS_DIR} @{HOME}/@{XDG_WALLPAPERS_DIR} @{MOUNTS}/@{XDG_DESKTOP_DIR}
@{user_dirs_strict} += @{MOUNTS}/@{XDG_SCREENSHOTS_DIR} @{MOUNTS}/@{XDG_WALLPAPERS_DIR}
@{user_dirs_strict} += @{user_books_dirs} @{user_documents_dirs} @{user_download_dirs} @{user_games_dirs} @{user_music_dirs} @{user_pictures_dirs}
@{user_dirs_strict} += @{user_projects_dirs} @{user_publicshare_dirs} @{user_sync_dirs} @{user_templates_dirs} @{user_torrents_dirs} @{user_videos_dirs}
@{user_dirs_strict} += @{user_vm_dirs} @{user_work_dirs}
