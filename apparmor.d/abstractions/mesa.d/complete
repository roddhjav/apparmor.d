# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2021-2024 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only

  # Extra Mesa rules for desktop environments
  owner @{desktop_cache_dirs}/ w,
  owner @{desktop_cache_dirs}/mesa_shader_cache/ rw,
  owner @{desktop_cache_dirs}/mesa_shader_cache/@{hex2}/ rw,
  owner @{desktop_cache_dirs}/mesa_shader_cache/@{hex2}/@{hex38} rw,
  owner @{desktop_cache_dirs}/mesa_shader_cache/@{hex2}/@{hex38}.tmp rwk,
  owner @{desktop_cache_dirs}/mesa_shader_cache/index rw,
  owner @{desktop_cache_dirs}/mesa_shader_cache/marker rw,
  
  owner @{user_cache_dirs}/mesa_shader_cache/marker rw,

  # Add a simple fallback for newest mesa shader cache that can't be detected
  owner @{user_cache_dirs}/mesa_shader_cache_db/* rwk,

# vim:syntax=apparmor
