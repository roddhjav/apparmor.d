# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2025 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only

# Common temporary tests directories used by autopkgtest.
#
# Do not use it manually, It is automatically included in the base abstraction
# when the 'test' prebuild flag is set.

  abi <abi/4.0>,

  # @{exec_path}.distrib mrix,

  @{lib}/installed-tests/ r,
  @{lib}/installed-tests/** rw,

  /usr/share/installed-tests/{,**} r,

  owner /m-a/{,**} rwlk,

  owner /test-dir/{,**} rw,
  owner /test-path/{,**} rw,
  owner /test-symlink/{,**} rw,
  owner /test/{,**} rw,

  owner /trigger{,s}/{,**} rw,

  /tmp/autopkgtest* rwlkmix,
  /tmp/autopkgtest*/ rw,
  /tmp/autopkgtest*/** rwlkmix,

  /tmp/shunit.@{rand6}/ rw,
  /tmp/shunit.@{rand6}/** rwlk,

  /tmp/test*/ rw,
  /tmp/test*/** rwlk,

  owner /tmp/g-r-d-tests-*/{,**} rwlk,

  include if exists <abstractions/tests.d>

# vim:syntax=apparmor
