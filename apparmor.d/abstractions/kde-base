# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2021-2025 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only

# Minimal kde specific rules.

  abi <abi/4.0>,

  @{lib}/kde{,3,4}/*.so mr,
  @{lib}/kde{,3,4}/plugins/*/ r,
  @{lib}/kde{,3,4}/plugins/*/*.so mr,

  /usr/share/knotifications{5,6}/*.notifyrc r,
  /usr/share/kubuntu-default-settings/{,**} r,

  /etc/xdg/baloofilerc r,
  /etc/xdg/kcminputrc r,
  /etc/xdg/kdeglobals r,
  /etc/xdg/kwinrc r,

  owner @{user_cache_dirs}/#@{int} rw,
  owner @{user_cache_dirs}/icon-cache.kcache rw,
  owner @{user_cache_dirs}/ksycoca{5,6}_??{_,-}* rwlk,

  owner @{user_config_dirs}/baloofilerc r,
  owner @{user_config_dirs}/dolphinrc r,
  owner @{user_config_dirs}/kcminputrc r,
  owner @{user_config_dirs}/kdedefaults/ r,
  owner @{user_config_dirs}/kdedefaults/kcminputrc r,
  owner @{user_config_dirs}/kdedefaults/kdeglobals r,
  owner @{user_config_dirs}/kdedefaults/kwinrc r,
  owner @{user_config_dirs}/kdeglobals r,
  owner @{user_config_dirs}/kwinrc r,
  owner @{user_config_dirs}/session/ rw,
  owner @{user_config_dirs}/session/* rwlk,
  owner @{user_config_dirs}/session/#@{int} rw,
  owner @{user_config_dirs}/trashrc r,

  owner @{user_share_dirs}/#@{int} rw,

  include if exists <abstractions/kde-base.d>

# vim:syntax=apparmor
