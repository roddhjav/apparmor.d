# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2025 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only
# LOGPROF-SUGGEST: no

  abi <abi/4.0>,

  unix type=stream addr=none peer=(label=xwayland, addr=@/tmp/.X11-unix/X@{int}),
  unix type=stream addr=none peer=(label=gnome-shell, addr=@/tmp/.X11-unix/X@{int}),
  unix (send receive connect) type=stream peer=(label=xkbcomp, addr=@/tmp/.X11-unix/X@{int}),

  /usr/share/X11/{,**} r,
  /usr/share/xkeyboard-config-2/{,**} r,

  owner @{run}/flatpak/Xauthority r,

  include if exists <abstractions/flatpak/sockets/x11.d>

# vim:syntax=apparmor
